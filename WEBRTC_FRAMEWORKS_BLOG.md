# ğŸ¦ åŒå‰‘åˆç’§ï¼šäº‘é›€ Voice-Agent å¼•å…¥ Kurento + LiveKit åŒ WebRTC æ¡†æ¶çš„æŠ€æœ¯å®è·µä¸å•†ä¸šä»·å€¼

> **æŠ€æœ¯åˆ†äº«** | ä½œè€…ï¼šSkylark Team | 2026-02-15
>
> ğŸ“‚ GitHubï¼š[https://github.com/Jashinck/Skylark](https://github.com/Jashinck/Skylark)  
> ğŸ“œ åè®®ï¼šApache License 2.0  
> â­ æ¬¢è¿ Starã€Forkã€Issueã€PRï¼Œä¸€èµ·æ‰“é€ çº¯ Java æ™ºèƒ½è¯­éŸ³äº¤äº’å¹³å°ï¼

---

<div align="center">

[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://github.com/Jashinck/Skylark/blob/main/LICENSE)
[![Java](https://img.shields.io/badge/Java-17-orange.svg)](https://www.oracle.com/java/)
[![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.2.0-brightgreen.svg)](https://spring.io/projects/spring-boot)
[![Kurento](https://img.shields.io/badge/Kurento-6.18.0-blueviolet.svg)](https://kurento.openvidu.io/)
[![LiveKit](https://img.shields.io/badge/LiveKit-0.12.0-ff69b4.svg)](https://livekit.io/)
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](https://github.com/Jashinck/Skylark/pulls)

</div>

---

## ğŸ“‹ ç›®å½•

- [ä¸€ã€å¼•è¨€ï¼šä¸ºä»€ä¹ˆ Voice-Agent éœ€è¦åŒå¼•æ“ï¼Ÿ](#ä¸€å¼•è¨€ä¸ºä»€ä¹ˆ-voice-agent-éœ€è¦åŒå¼•æ“)
- [äºŒã€äº‘é›€é¡¹ç›®å›é¡¾](#äºŒäº‘é›€é¡¹ç›®å›é¡¾)
- [ä¸‰ã€Kurento â€” è‡ªæ‰˜ç®¡åª’ä½“å¤„ç†çš„é‡æ­¦å™¨](#ä¸‰kurento--è‡ªæ‰˜ç®¡åª’ä½“å¤„ç†çš„é‡æ­¦å™¨)
- [å››ã€LiveKit â€” äº‘åŸç”Ÿæ—¶ä»£çš„è½»é‡çº§æ–°æ˜Ÿ](#å››livekit--äº‘åŸç”Ÿæ—¶ä»£çš„è½»é‡çº§æ–°æ˜Ÿ)
- [äº”ã€ç­–ç•¥æ¨¡å¼ï¼šä¸€ä¸ªæ¥å£ã€ä¸‰ç§å®ç°ã€é›¶æ„Ÿåˆ‡æ¢](#äº”ç­–ç•¥æ¨¡å¼ä¸€ä¸ªæ¥å£ä¸‰ç§å®ç°é›¶æ„Ÿåˆ‡æ¢)
- [å…­ã€åŒæ¡†æ¶å¯¹æ¯”ä¸ååŒ](#å…­åŒæ¡†æ¶å¯¹æ¯”ä¸ååŒ)
- [ä¸ƒã€å¯¹äº‘é›€ Voice-Agent çš„æŠ€æœ¯æ”¶ç›Š](#ä¸ƒå¯¹äº‘é›€-voice-agent-çš„æŠ€æœ¯æ”¶ç›Š)
- [å…«ã€ç»™å°å¾®ä¼ä¸šå¸¦æ¥çš„å•†ä¸šä»·å€¼](#å…«ç»™å°å¾®ä¼ä¸šå¸¦æ¥çš„å•†ä¸šä»·å€¼)
- [ä¹ã€å¿«é€Ÿä¸Šæ‰‹æŒ‡å—](#ä¹å¿«é€Ÿä¸Šæ‰‹æŒ‡å—)
- [åã€åç»­è§„åˆ’ä¸å¼€æºå…±å»ºé‚€è¯·](#ååç»­è§„åˆ’ä¸å¼€æºå…±å»ºé‚€è¯·)
- [åä¸€ã€æ€»ç»“](#åä¸€æ€»ç»“)
- [é™„å½•ï¼šå¦‚ä½•å‚ä¸è´¡çŒ®](#é™„å½•å¦‚ä½•å‚ä¸è´¡çŒ®)

---

## ä¸€ã€å¼•è¨€ï¼šä¸ºä»€ä¹ˆ Voice-Agent éœ€è¦åŒå¼•æ“ï¼Ÿ

åœ¨ AI è¯­éŸ³äº¤äº’é¢†åŸŸï¼Œ**å®æ—¶é€šä¿¡ï¼ˆRTCï¼‰** æ˜¯è¿æ¥ç”¨æˆ·ä¸æ™ºèƒ½ä½“ä¹‹é—´çš„"æœ€åä¸€å…¬é‡Œ"ã€‚ä¸€ä¸ªä¼˜ç§€çš„ Voice-Agent ç³»ç»Ÿä¸ä»…éœ€è¦å…·å¤‡ VADï¼ˆè¯­éŸ³æ£€æµ‹ï¼‰â†’ ASRï¼ˆè¯­éŸ³è¯†åˆ«ï¼‰â†’ LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰â†’ TTSï¼ˆè¯­éŸ³åˆæˆï¼‰çš„å®Œæ•´ç¼–æ’èƒ½åŠ›ï¼Œæ›´éœ€è¦ä¸€ä¸ª**é«˜è´¨é‡ã€ä½å»¶è¿Ÿã€å¯é çš„å®æ—¶éŸ³é¢‘ä¼ è¾“é€šé“**ã€‚

ç„¶è€Œï¼Œå®é™…ç”Ÿäº§ä¸­ï¼Œä¸åŒè§„æ¨¡çš„ä¼ä¸šå¯¹ WebRTC æ–¹æ¡ˆçš„è¯‰æ±‚æˆªç„¶ä¸åŒï¼š

| åœºæ™¯ | è¯‰æ±‚ | é€‚é…æ–¹æ¡ˆ |
|------|------|----------|
| éœ€è¦æœåŠ¡ç«¯å½•åˆ¶ã€è½¬ç ã€æ··éŸ³ | åª’ä½“æµå¿…é¡»ç»è¿‡æœåŠ¡ç«¯ | **Kurento**ï¼ˆSFU/MCUï¼‰ |
| è¿½æ±‚è½»é‡éƒ¨ç½²ã€äº‘åŸç”Ÿæ¶æ„ | æœ€å°‘è¿ç»´ã€å¼¹æ€§æ‰©ç¼©å®¹ | **LiveKit**ï¼ˆSFUï¼‰ |
| ç§æœ‰åŒ–éƒ¨ç½²ã€æ•°æ®ä¸å‡ºåŸŸ | å…¨é“¾è·¯è‡ªæ‰˜ç®¡ | **Kurento** |
| å¿«é€Ÿæ¥å…¥ã€Token é‰´æƒå³ç”¨ | ä½å­¦ä¹ æˆæœ¬ã€å¿«é€Ÿä¸Šçº¿ | **LiveKit** |

æ­£æ˜¯åŸºäºä»¥ä¸Šè€ƒé‡ï¼Œäº‘é›€é¡¹ç›®åœ¨å·²æœ‰ WebSocket åŸºç¡€æ–¹æ¡ˆçš„åŸºç¡€ä¸Šï¼Œå…ˆåå¼•å…¥äº† **Kurento 6.18.0** å’Œ **LiveKit 0.12.0** ä¸¤å¤§ WebRTC æ¡†æ¶ï¼Œå¹¶é€šè¿‡**ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰**å®ç°äº†ä¸‰ç§é€šé“çš„æ— ç¼åˆ‡æ¢ï¼Œè®©å¼€å‘è€…å’Œä¼ä¸šèƒ½å¤ŸæŒ‰éœ€é€‰æ‹©æœ€é€‚åˆè‡ªèº«åœºæ™¯çš„å®æ—¶é€šä¿¡æ–¹æ¡ˆã€‚

---

## äºŒã€äº‘é›€é¡¹ç›®å›é¡¾

**äº‘é›€ï¼ˆSkylarkï¼‰** â€” *ç”Ÿäºäº‘ç«¯ï¼Œé¸£äºæŒ‡å°–* â€” æ˜¯ä¸€ä¸ªåŸºäº**çº¯ Java ç”Ÿæ€**æ„å»ºçš„æ™ºèƒ½è¯­éŸ³äº¤äº’ä»£ç†ç³»ç»Ÿï¼ˆVoice-Agentï¼‰ã€‚

> ğŸ’¡ **ä¸€å¥è¯ä»‹ç»**ï¼šæ— éœ€ Python ä¾èµ–ï¼Œå•ä¸€ JAR åŒ…å³å¯è¿è¡Œï¼Œé›†æˆ VAD + ASR + LLM + TTS + WebRTC å®Œæ•´é“¾è·¯çš„ AI è¯­éŸ³äº¤äº’å¹³å°ã€‚

### æ ¸å¿ƒèƒ½åŠ›å…¨æ™¯

| æ¨¡å— | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| **VAD** | Silero + ONNX Runtime 1.16.3 | åŸºäºæ·±åº¦å­¦ä¹ çš„è¯­éŸ³æ´»åŠ¨æ£€æµ‹ |
| **ASR** | Vosk 0.3.45 | ç¦»çº¿è¯­éŸ³è¯†åˆ«ï¼Œæ”¯æŒä¸­æ–‡ |
| **LLM** | å¯æ’æ‹”åç«¯ï¼ˆOllama / OpenAIï¼‰ | å¤§è¯­è¨€æ¨¡å‹æ™ºèƒ½å¯¹è¯ |
| **TTS** | MaryTTS / å¯æ‰©å±• | æ–‡æœ¬è½¬è¯­éŸ³åˆæˆ |
| **RTC** | WebSocket / Kurento 6.18.0 / LiveKit 0.12.0 | ğŸ†• ä¸‰ç§ WebRTC é€šé“ç­–ç•¥ |

### æŠ€æœ¯æ ˆ

```
Java 17 + Spring Boot 3.2.0 + Maven
â”œâ”€â”€ Vosk 0.3.45           (ç¦»çº¿ ASR)
â”œâ”€â”€ ONNX Runtime 1.16.3   (Silero VAD)
â”œâ”€â”€ Kurento Client 6.18.0 (WebRTC åª’ä½“æœåŠ¡å™¨)
â”œâ”€â”€ LiveKit Server 0.12.0 (äº‘åŸç”Ÿ WebRTC)
â””â”€â”€ Spring Web/WebSocket/WebFlux
```

---

## ä¸‰ã€Kurento â€” è‡ªæ‰˜ç®¡åª’ä½“å¤„ç†çš„é‡æ­¦å™¨

### 3.1 ä¸ºä»€ä¹ˆå¼•å…¥ Kurentoï¼Ÿ

åœ¨äº‘é›€é¡¹ç›®çš„æ—©æœŸé˜¶æ®µï¼Œæˆ‘ä»¬çš„éŸ³é¢‘ä¼ è¾“ä¾èµ–è‡ªå®šä¹‰ WebSocket åè®®ã€‚è™½ç„¶èƒ½æ»¡è¶³åŸºæœ¬çš„è¯­éŸ³äº¤äº’éœ€æ±‚ï¼Œä½†åœ¨ä»¥ä¸‹æ–¹é¢å­˜åœ¨æ˜æ˜¾çŸ­æ¿ï¼š

- âŒ **éæ ‡å‡†åŒ–**ï¼šæ— æ³•åˆ©ç”¨æµè§ˆå™¨åŸç”Ÿ WebRTC çš„ NAT ç©¿é€ã€å›å£°æ¶ˆé™¤ã€é™å™ªç­‰èƒ½åŠ›
- âŒ **æ— æœåŠ¡ç«¯åª’ä½“å¤„ç†**ï¼šæ— æ³•åœ¨æœåŠ¡ç«¯å½•åˆ¶ã€è½¬ç ã€æ··éŸ³
- âŒ **æ‰©å±•æ€§å—é™**ï¼šéš¾ä»¥æ”¯æŒå¤šæ–¹é€šè¯ç­‰å¤æ‚åœºæ™¯

**Kurento Media Server** ä»¥å¼€æºã€æˆç†Ÿã€Java åŸç”Ÿçš„ç‰¹æ€§ï¼Œæˆä¸ºäº†æˆ‘ä»¬çš„é¦–é€‰ï¼š

- âœ… **Apache 2.0 åè®®**ï¼Œä¸äº‘é›€é¡¹ç›®ä¸€è‡´
- âœ… **kurento-client Java SDK**ï¼Œä¸ Spring Boot æ— ç¼é›†æˆ
- âœ… **MediaPipeline æ¨¡å‹**ï¼ŒéŸ³é¢‘æµå¯åœ¨æœåŠ¡ç«¯ä»»æ„ç¼–æ’
- âœ… **æ ‡å‡† WebRTC**ï¼Œæµè§ˆå™¨åŸç”Ÿæ”¯æŒï¼ŒICE/STUN/TURN å†…å»º
- âœ… **æœåŠ¡ç«¯åª’ä½“å¤„ç†**ï¼Œæ”¯æŒå½•åˆ¶ã€æ··éŸ³ã€è½¬ç ã€æ»¤é•œ

### 3.2 äº‘é›€ä¸­çš„ Kurento æ¶æ„

```
ğŸ–¥ï¸ Browser (kurento-demo.html)
     â”‚
     â”‚ REST API (SDP/ICE)
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RobotController (Kurento Endpoints) â”‚
â”‚  POST /api/webrtc/kurento/session    â”‚
â”‚  POST /session/{id}/offer            â”‚
â”‚  POST /session/{id}/ice-candidate    â”‚
â”‚  DELETE /session/{id}                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WebRTCService (åº”ç”¨å±‚)              â”‚
â”‚  ä¼šè¯ç®¡ç† + VADâ†’ASRâ†’LLMâ†’TTS ç¼–æ’    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  KurentoChannelStrategy (ç­–ç•¥å®ç°)    â”‚
â”‚  â†“                                   â”‚
â”‚  KurentoClientAdapterImpl            â”‚
â”‚  â€¢ MediaPipeline åˆ›å»ºä¸ç¼“å­˜          â”‚
â”‚  â€¢ WebRtcEndpoint é…ç½® (STUN/TURN)   â”‚
â”‚  â€¢ å¥åº·æ£€æŸ¥ + æŒ‡æ•°é€€é¿è‡ªåŠ¨é‡è¿        â”‚
â”‚  â€¢ ä¼˜é›…å…³é—­ + èµ„æºé‡Šæ”¾               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ WebSocket (JSON-RPC)
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Kurento Media Server (Docker)       â”‚
â”‚  ws://localhost:8888/kurento         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 æ ¸å¿ƒå®ç°äº®ç‚¹

#### â‘  è‡ªåŠ¨å¥åº·æ£€æŸ¥ä¸æŒ‡æ•°é€€é¿é‡è¿

```java
@Scheduled(fixedDelay = 30000, initialDelay = 30000)
public void healthCheck() {
    try {
        kurentoClient.getServerManager().getInfo(); // å¿ƒè·³æ¢æµ‹
        if (!connected) {
            connected = true;
            reconnectDelayMs = INITIAL_RECONNECT_DELAY_MS; // æ¢å¤åé‡ç½®
        }
    } catch (Exception e) {
        connected = false;
        attemptReconnect(); // æŒ‡æ•°é€€é¿: 1s â†’ 2s â†’ 4s â†’ ... â†’ 60s
    }
}
```

#### â‘¡ å®Œæ•´çš„ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†

WebRTCSession å°è£…äº†å•ä¸ª WebRTC ä¼šè¯çš„å…¨éƒ¨çŠ¶æ€ï¼ŒåŒ…æ‹¬ MediaPipelineã€WebRtcEndpointã€äº‹ä»¶ç›‘å¬ï¼Œä»¥åŠèµ„æºçš„å¹‚ç­‰é‡Šæ”¾ã€‚

#### â‘¢ AudioProcessor éŸ³é¢‘æ¡¥æ¥

Kurento çš„éŸ³é¢‘æµé€šè¿‡ AudioProcessor æ¡¥æ¥åˆ° VAD/ASR ç®¡é“ï¼Œå®ç°äº† WebRTC åª’ä½“æµä¸ AI è¯­éŸ³å¤„ç†çš„æ— ç¼è¡”æ¥ã€‚

---

## å››ã€LiveKit â€” äº‘åŸç”Ÿæ—¶ä»£çš„è½»é‡çº§æ–°æ˜Ÿ

### 4.1 ä¸ºä»€ä¹ˆè¿˜éœ€è¦ LiveKitï¼Ÿ

Kurento æ˜¯ä¸€æŠŠåŠŸèƒ½å¼ºå¤§çš„"é‡æ­¦å™¨"ï¼Œä½†åœ¨æŸäº›åœºæ™¯ä¸‹å¯èƒ½æ˜¾å¾—"å¤§æå°ç”¨"ï¼š

- Kurento Media Server éœ€è¦ç‹¬ç«‹éƒ¨ç½²å’Œè¿ç»´
- å¯¹äºåªéœ€è¦æ ‡å‡†éŸ³è§†é¢‘ä¼ è¾“ã€ä¸éœ€è¦æœåŠ¡ç«¯åª’ä½“å¤„ç†çš„åœºæ™¯ï¼Œéƒ¨ç½²æˆæœ¬åé«˜
- åœ¨äº‘åŸç”Ÿå’Œ Kubernetes ç¯å¢ƒä¸‹ï¼ŒLiveKit çš„å®¹å™¨åŒ–å‹å¥½åº¦æ›´é«˜

**LiveKit** ä½œä¸ºæ–°ä¸€ä»£å¼€æº WebRTC æ¡†æ¶ï¼Œå¸¦æ¥äº†æˆªç„¶ä¸åŒçš„è®¾è®¡ç†å¿µï¼š

- âœ… **äº‘åŸç”Ÿæ¶æ„**ï¼šGo è¯­è¨€å®ç°ï¼Œå¤©ç„¶é€‚é… K8sï¼Œèµ„æºå ç”¨æä½
- âœ… **Token é‰´æƒ**ï¼šJWT Token å³å¯å®Œæˆæ¥å…¥ï¼Œå®¢æˆ·ç«¯æ— éœ€å¤æ‚çš„ SDP/ICE æ‰‹åŠ¨åå•†
- âœ… **Room æ¨¡å‹**ï¼šåŸºäºæˆ¿é—´çš„ä¼šè¯ç®¡ç†ï¼Œå¤©ç„¶æ”¯æŒå¤šäººåœºæ™¯
- âœ… **ä¸°å¯Œçš„ SDK**ï¼šæä¾› JavaScriptã€Goã€Pythonã€Java ç­‰å¤šè¯­è¨€ SDK
- âœ… **å®Œå–„çš„ç”Ÿæ€**ï¼šå†…å»ºå½•åˆ¶ã€Egress/Ingress ç­‰é«˜çº§åŠŸèƒ½

### 4.2 äº‘é›€ä¸­çš„ LiveKit æ¶æ„

```
ğŸ–¥ï¸ Browser (livekit-demo.html)
     â”‚
     â”‚ â‘  REST API åˆ›å»ºä¼šè¯è·å– Token
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RobotController (LiveKit Endpoints) â”‚
â”‚  POST /api/webrtc/livekit/session    â”‚
â”‚  DELETE /session/{sessionId}         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LiveKitChannelStrategy (ç­–ç•¥å®ç°)    â”‚
â”‚  â†“                                   â”‚
â”‚  LiveKitClientAdapterImpl            â”‚
â”‚  â€¢ Room åˆ›å»ºä¸ç®¡ç†                    â”‚
â”‚  â€¢ JWT Token ç”Ÿæˆ                    â”‚
â”‚  â€¢ è¿æ¥çŠ¶æ€ç›‘æ§                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LiveKit Server (Docker/Cloud)       â”‚
â”‚  wss://livekit.example.com           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ â‘¡ å®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨ Token
               â”‚   è¿æ¥ LiveKit Server
               â†“
ğŸ–¥ï¸ Browser (livekit-client SDK v2.6.4)
     â€¢ è‡ªåŠ¨ SDP/ICE åå•†
     â€¢ è‡ªåŠ¨é‡è¿ (æŒ‡æ•°é€€é¿)
     â€¢ è¿æ¥è´¨é‡ç›‘æ§
```

### 4.3 æ ¸å¿ƒå®ç°äº®ç‚¹

#### â‘  æç®€çš„æ¥å…¥æµç¨‹

ä¸ Kurento éœ€è¦æ‰‹åŠ¨ SDP/ICE åå•†ä¸åŒï¼ŒLiveKit çš„æ¥å…¥åªéœ€ä¸¤æ­¥ï¼š

1. **æœåŠ¡ç«¯**ï¼šåˆ›å»º Room + ç”Ÿæˆ JWT Token
2. **å®¢æˆ·ç«¯**ï¼šä½¿ç”¨ Token ç›´æ¥è¿æ¥ LiveKit Server

```java
// æœåŠ¡ç«¯ â€” LiveKitClientAdapterImpl
public String generateToken(String roomName, String participantIdentity) {
    AccessToken token = new AccessToken(apiKey, apiSecret);
    token.setName(participantIdentity);
    token.setIdentity(participantIdentity);
    token.addGrants(new RoomJoin(true), new RoomName(roomName));
    return token.toJwt();
}
```

```javascript
// å®¢æˆ·ç«¯ â€” livekit-webrtc.js
async connectToRoom(url, token) {
    this.room = new LivekitClient.Room();
    await this.room.connect(url, token);
    // å®Œæˆï¼æ— éœ€æ‰‹åŠ¨å¤„ç† SDP/ICE
}
```

#### â‘¡ è‡ªåŠ¨é‡è¿ä¸è¿æ¥è´¨é‡ç›‘æ§

```javascript
// å®¢æˆ·ç«¯å†…å»ºæ–­çº¿é‡è¿
this.room.on(LivekitClient.RoomEvent.Reconnecting, () => {
    this.log('æ­£åœ¨é‡æ–°è¿æ¥...');
});

this.room.on(LivekitClient.RoomEvent.ConnectionQualityChanged, (quality) => {
    this.log(`è¿æ¥è´¨é‡å˜åŒ–: ${quality}`);
});
```

#### â‘¢ Room æ¨¡å‹å¤©ç„¶æ”¯æŒå¤šäºº

LiveKit çš„ Room æ¨¡å‹ä½¿å¾—ä» 1v1 æ‰©å±•åˆ°å¤šäººåœºæ™¯å‡ ä¹é›¶æˆæœ¬ï¼Œè¿™å¯¹äºæœªæ¥å¤šæ–¹è¯­éŸ³ä¼šè®®ã€å¤š Agent åä½œç­‰åœºæ™¯å…·æœ‰é‡è¦ä»·å€¼ã€‚

---

## äº”ã€ç­–ç•¥æ¨¡å¼ï¼šä¸€ä¸ªæ¥å£ã€ä¸‰ç§å®ç°ã€é›¶æ„Ÿåˆ‡æ¢

### 5.1 è®¾è®¡ç†å¿µ

äº‘é›€é‡‡ç”¨**ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰**ç»Ÿä¸€ç®¡ç†ä¸‰ç§ WebRTC é€šé“å®ç°ï¼Œè¿™æ˜¯æœ¬æ¬¡åŒæ¡†æ¶å¼•å…¥ä¸­æœ€å…³é”®çš„æ¶æ„è®¾è®¡ï¼š

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  WebRTCChannelStrategy   â”‚  â† ç»Ÿä¸€æ¥å£
                    â”‚  (ç­–ç•¥æ¥å£)               â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â†“                 â†“                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WebSocketChannel â”‚ â”‚ KurentoChannel   â”‚ â”‚ LiveKitChannel   â”‚
â”‚ Strategy         â”‚ â”‚ Strategy         â”‚ â”‚ Strategy         â”‚
â”‚ (åŸºç¡€æ–¹æ¡ˆ)        â”‚ â”‚ (åª’ä½“å¤„ç†æ–¹æ¡ˆ)    â”‚ â”‚ (äº‘åŸç”Ÿæ–¹æ¡ˆ)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ç»Ÿä¸€æ¥å£å®šä¹‰

```java
public interface WebRTCChannelStrategy {
    String getStrategyName();
    String createSession(String userId);
    String processOffer(String sessionId, String sdpOffer);
    void addIceCandidate(String sessionId, String candidate, String sdpMid, int sdpMLineIndex);
    void closeSession(String sessionId);
    boolean sessionExists(String sessionId);
    int getActiveSessionCount();
    boolean isAvailable();
}
```

### 5.3 ä¸€è¡Œé…ç½®åˆ‡æ¢

```yaml
# application.yaml â€” åªéœ€ä¿®æ”¹è¿™ä¸€è¡Œå³å¯åˆ‡æ¢ WebRTC å¼•æ“
webrtc:
  strategy: websocket   # å¯é€‰: websocket / kurento / livekit
```

```java
// WebRTCStrategyConfig.java â€” æ ¹æ®é…ç½®è‡ªåŠ¨æ³¨å…¥å¯¹åº”ç­–ç•¥
@Bean
public WebRTCChannelStrategy webRTCChannelStrategy() {
    switch (strategyName.toLowerCase()) {
        case "kurento":  return new KurentoChannelStrategy(kurentoClientAdapter);
        case "livekit":  return new LiveKitChannelStrategy(liveKitClientAdapter);
        default:         return new WebSocketChannelStrategy();
    }
}
```

### 5.4 è¿™ä¸ªè®¾è®¡çš„ä»·å€¼

| ç»´åº¦ | æ”¶ç›Š |
|------|------|
| **å¼€é—­åŸåˆ™** | æ–°å¢ WebRTC æ–¹æ¡ˆï¼ˆå¦‚å£°ç½‘ Agoraï¼‰åªéœ€å®ç°æ¥å£ï¼Œä¸æ”¹å·²æœ‰ä»£ç  |
| **è¿è¡Œæ—¶åˆ‡æ¢** | é€šè¿‡é…ç½®æ–‡ä»¶å³å¯åˆ‡æ¢ï¼Œæ— éœ€ä¿®æ”¹ä»£ç æˆ–é‡æ–°ç¼–è¯‘ |
| **ç‹¬ç«‹æµ‹è¯•** | æ¯ç§ç­–ç•¥å¯ç‹¬ç«‹è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œäº’ä¸å¹²æ‰° |
| **æ¸è¿›è¿ç§»** | ä¼ä¸šå¯å…ˆç”¨ WebSocket éªŒè¯ï¼Œå†å¹³æ»‘å‡çº§åˆ° Kurento æˆ– LiveKit |

---

## å…­ã€åŒæ¡†æ¶å¯¹æ¯”ä¸ååŒ

### 6.1 ç‰¹æ€§å¯¹æ¯”

| å¯¹æ¯”ç»´åº¦ | Kurento 6.18.0 | LiveKit 0.12.0 |
|----------|----------------|----------------|
| **æ¶æ„æ¨¡å‹** | SFU / MCUï¼ˆåª’ä½“ç®¡é“ï¼‰ | SFUï¼ˆæˆ¿é—´æ¨¡å‹ï¼‰ |
| **æ ¸å¿ƒè¯­è¨€** | Java (Client) + C++ (Server) | Go (Server) + å¤šè¯­è¨€ SDK |
| **éƒ¨ç½²æ–¹å¼** | Docker / ç‹¬ç«‹è¿›ç¨‹ | Docker / K8s / äº‘æœåŠ¡ |
| **åª’ä½“å¤„ç†** | âœ… å½•åˆ¶ã€æ··éŸ³ã€è½¬ç ã€æ»¤é•œ | âœ… å½•åˆ¶ï¼ˆEgressï¼‰ã€å¯¼å…¥ï¼ˆIngressï¼‰ |
| **SDP åå•†** | æ‰‹åŠ¨ Offer/Answer + ICE | è‡ªåŠ¨ï¼ˆToken å³ç”¨ï¼‰ |
| **NAT ç©¿é€** | å†…å»º ICE/STUN/TURN | å†…å»º ICE/STUN/TURN |
| **æ¥å…¥å¤æ‚åº¦** | ä¸­ç­‰ï¼ˆéœ€ç†è§£ SDP/ICE æµç¨‹ï¼‰ | ä½ï¼ˆToken é‰´æƒå³å¯ï¼‰ |
| **èµ„æºå ç”¨** | è¾ƒé«˜ï¼ˆC++ åª’ä½“æœåŠ¡å™¨ï¼‰ | è¾ƒä½ï¼ˆGo è¿è¡Œæ—¶ï¼‰ |
| **ç¤¾åŒºæ´»è·ƒåº¦** | æˆç†Ÿç¨³å®šï¼Œæ–‡æ¡£ä¸°å¯Œ | å¿«é€Ÿå¢é•¿ï¼ŒåŠ¿å¤´å¼ºåŠ² |
| **Java é›†æˆ** | â­ kurento-client åŸç”Ÿ SDK | livekit-server SDK |
| **åè®®** | Apache 2.0 | Apache 2.0 |

### 6.2 é€‚ç”¨åœºæ™¯çŸ©é˜µ

```
                    ä½éƒ¨ç½²æˆæœ¬  â†â€”â€”â†’  é«˜éƒ¨ç½²æˆæœ¬
                        â”‚                â”‚
    LiveKit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
    (å¿«é€Ÿæ¥å…¥ã€äº‘åŸç”Ÿ)    â”‚                â”‚
                        â”‚                â”‚
                        â”‚     Kurento â”€â”€â”€â”¤
                        â”‚     (åª’ä½“å¤„ç†ã€ â”‚
                        â”‚      ç§æœ‰åŒ–)    â”‚
                        â”‚                â”‚
    ä½åª’ä½“å¤„ç†éœ€æ±‚  â†â€”â€”â†’  é«˜åª’ä½“å¤„ç†éœ€æ±‚
```

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | ç†ç”± |
|------|----------|------|
| åˆåˆ›å…¬å¸å¿«é€Ÿæ¥å…¥è¯­éŸ³å®¢æœ | **LiveKit** | éƒ¨ç½²ç®€å•ï¼ŒToken é‰´æƒï¼Œåˆ†é’Ÿçº§ä¸Šçº¿ |
| é‡‘è/åŒ»ç–—è¡Œä¸šçš„ç§æœ‰åŒ–éƒ¨ç½² | **Kurento** | å…¨é“¾è·¯è‡ªæ‰˜ç®¡ï¼Œæ•°æ®ä¸å‡ºåŸŸ |
| éœ€è¦é€šè¯å½•åˆ¶ä¸è´¨æ£€åˆ†æ | **Kurento** | æœåŠ¡ç«¯ MediaPipeline åŸç”Ÿæ”¯æŒ |
| K8s å¾®æœåŠ¡æ¶æ„çš„äº‘åŸç”Ÿä¼ä¸š | **LiveKit** | Go è¿è¡Œæ—¶ï¼Œå®¹å™¨å‹å¥½ï¼Œå¼¹æ€§ä¼¸ç¼© |
| å¤šäººè¯­éŸ³ä¼šè®® + AI Agent | **LiveKit** | Room æ¨¡å‹å¤©ç„¶æ”¯æŒå¤šæ–¹ |
| éœ€è¦å®æ—¶éŸ³é¢‘è½¬ç /æ··éŸ³ | **Kurento** | MediaElement å¯ç»„åˆæ¶æ„ |

### 6.3 ååŒä»·å€¼

åŒæ¡†æ¶å¹¶éäº’ç›¸æ›¿ä»£ï¼Œè€Œæ˜¯äº’ä¸ºè¡¥å……ï¼š

- **å¼€å‘é˜¶æ®µ**ï¼šä½¿ç”¨ WebSocket ç­–ç•¥å¿«é€ŸåŸå‹éªŒè¯
- **æµ‹è¯•é˜¶æ®µ**ï¼šåˆ‡æ¢åˆ° LiveKit è¿›è¡Œé›†æˆæµ‹è¯•ï¼ˆéƒ¨ç½²ç®€å•ï¼‰
- **ç”Ÿäº§é˜¶æ®µ**ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹© Kurentoï¼ˆé‡åª’ä½“å¤„ç†ï¼‰æˆ– LiveKitï¼ˆè½»é‡äº‘åŸç”Ÿï¼‰

è¿™ç§"æ¸è¿›å¼å‡çº§"çš„è·¯å¾„å¯¹äºå°å¾®ä¼ä¸šå°¤ä¸ºå‹å¥½â€”â€”ä¸éœ€è¦ä¸€æ­¥åˆ°ä½ï¼Œå¯ä»¥éšç€ä¸šåŠ¡å‘å±•é€æ­¥å‡çº§å®æ—¶é€šä¿¡èƒ½åŠ›ã€‚

---

## ä¸ƒã€å¯¹äº‘é›€ Voice-Agent çš„æŠ€æœ¯æ”¶ç›Š

å¼•å…¥ Kurento å’Œ LiveKit åŒæ¡†æ¶åï¼Œäº‘é›€ Voice-Agent è·å¾—äº†æ˜¾è‘—çš„æŠ€æœ¯èƒ½åŠ›æå‡ï¼š

### 7.1 ä»"èƒ½ç”¨"åˆ°"å¥½ç”¨"

| ç»´åº¦ | å¼•å…¥å‰ï¼ˆWebSocketï¼‰ | å¼•å…¥åï¼ˆKurento + LiveKitï¼‰ |
|------|---------------------|---------------------------|
| **éŸ³é¢‘è´¨é‡** | WebSocket äºŒè¿›åˆ¶ä¼ è¾“ | WebRTC æ ‡å‡†ï¼ˆå›å£°æ¶ˆé™¤ã€é™å™ªã€è‡ªåŠ¨å¢ç›Šï¼‰ |
| **NAT ç©¿é€** | éœ€è‡ªè¡Œå¤„ç† | ICE/STUN/TURN å†…å»º |
| **è¿æ¥ç¨³å®šæ€§** | ä¾èµ– WebSocket | WebRTC + è‡ªåŠ¨é‡è¿ + å¥åº·æ£€æŸ¥ |
| **å»¶è¿Ÿ** | å— WebSocket å¸§é™åˆ¶ | WebRTC UDP å®æ—¶ä¼ è¾“ |
| **æµè§ˆå™¨å…¼å®¹** | éœ€è‡ªå®šä¹‰å½•éŸ³é€»è¾‘ | æµè§ˆå™¨åŸç”Ÿ WebRTC API |

### 7.2 æ¶æ„ä¼˜åŠ¿

- **å¯æ’æ‹”è®¾è®¡**ï¼šç­–ç•¥æ¨¡å¼è®© WebRTC é€šé“å¯æ›¿æ¢ï¼Œæ¶æ„ä¸ä¸ä»»ä½•å•ä¸€æ¡†æ¶è€¦åˆ
- **æ¸è¿›è¿ç§»**ï¼šä» WebSocket â†’ Kurento â†’ LiveKitï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯å¹³æ»‘è¿‡æ¸¡
- **ç‹¬ç«‹æ¼”è¿›**ï¼šKurento å’Œ LiveKit çš„å®ç°äº’ä¸å¹²æ‰°ï¼Œå¯ä»¥ç‹¬ç«‹å‡çº§å’Œä¼˜åŒ–
- **æµ‹è¯•å‹å¥½**ï¼š130+ å•å…ƒæµ‹è¯•è¦†ç›–ï¼ŒåŒ…å« Kurento å’Œ LiveKit çš„ä¸“é¡¹æµ‹è¯•

### 7.3 ç”Ÿæ€æ‰©å±•èƒ½åŠ›

åŒæ¡†æ¶çš„å¼•å…¥ä¸ºäº‘é›€å»ºç«‹äº†ä¸€ä¸ªå¯æ‰©å±•çš„ WebRTC é€‚é…å±‚ï¼Œæœªæ¥æ¥å…¥å£°ç½‘ Agoraã€è…¾è®¯äº‘ TRTC ç­‰å•†ä¸š RTC-PaaS æ—¶ï¼Œåªéœ€å®ç° `WebRTCChannelStrategy` æ¥å£å³å¯ï¼Œæ— éœ€ä¿®æ”¹ä¸Šå±‚ä¸šåŠ¡é€»è¾‘ã€‚

```
æœªæ¥æ‰©å±•è·¯å¾„ï¼š
WebRTCChannelStrategy
â”œâ”€â”€ WebSocketChannelStrategy  âœ… å·²å®ç°
â”œâ”€â”€ KurentoChannelStrategy    âœ… å·²å®ç°
â”œâ”€â”€ LiveKitChannelStrategy    âœ… å·²å®ç°
â”œâ”€â”€ AgoraChannelStrategy      ğŸ”œ è§„åˆ’ä¸­
â”œâ”€â”€ TRTCChannelStrategy       ğŸ”œ è§„åˆ’ä¸­
â””â”€â”€ ...                       ğŸ”œ æ›´å¤š
```

---

## å…«ã€ç»™å°å¾®ä¼ä¸šå¸¦æ¥çš„å•†ä¸šä»·å€¼

å¯¹äºå°å¾®ä¼ä¸šè€Œè¨€ï¼Œäº‘é›€æ­è½½åŒ WebRTC æ¡†æ¶åï¼Œå¯ä»¥ç›´æ¥è½¬åŒ–ä¸ºå®å®åœ¨åœ¨çš„ä¸šåŠ¡ä»·å€¼ï¼š

### 8.1 æ™ºèƒ½å®¢æœç³»ç»Ÿ â€” é™ä½ 70% äººåŠ›æˆæœ¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            æ™ºèƒ½è¯­éŸ³å®¢æœæ–¹æ¡ˆ                    â”‚
â”‚                                              â”‚
â”‚  å®¢æˆ·æ¥ç”µ                                     â”‚
â”‚    â†“                                         â”‚
â”‚  WebRTC å®æ—¶è¿æ¥ï¼ˆLiveKit / Kurentoï¼‰          â”‚
â”‚    â†“                                         â”‚
â”‚  VAD â†’ æ£€æµ‹å®¢æˆ·è¯´è¯                            â”‚
â”‚    â†“                                         â”‚
â”‚  ASR â†’ "æˆ‘æƒ³æŸ¥ä¸€ä¸‹ä¸Šä¸ªæœˆçš„è´¦å•"                  â”‚
â”‚    â†“                                         â”‚
â”‚  LLM â†’ ç†è§£æ„å›¾ï¼ŒæŸ¥è¯¢æ•°æ®åº“ï¼Œç”Ÿæˆå›å¤            â”‚
â”‚    â†“                                         â”‚
â”‚  TTS â†’ "æ‚¨ä¸Šä¸ªæœˆçš„è´¦å•é‡‘é¢ä¸º1280å…ƒ..."           â”‚
â”‚    â†“                                         â”‚
â”‚  WebRTC å®æ—¶å›ä¼ è¯­éŸ³                           â”‚
â”‚                                              â”‚
â”‚  ğŸ’° æ”¶ç›Šï¼š7Ã—24 æ— ä¼‘ï¼Œå¤„ç† 80% å¸¸è§å’¨è¯¢          â”‚
â”‚  ğŸ“‰ æˆæœ¬ï¼šæ›¿ä»£ 3-5 åå®¢æœäººåŠ›                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸ºä»€ä¹ˆåŒæ¡†æ¶æ›´æœ‰ä»·å€¼ï¼Ÿ**
- ä½¿ç”¨ **LiveKit** å¿«é€Ÿä¸Šçº¿åŸºç¡€å®¢æœåŠŸèƒ½ï¼ˆ1 å‘¨å†…éƒ¨ç½²å®Œæˆï¼‰
- ä¸šåŠ¡ç¨³å®šååˆ‡æ¢ **Kurento** å®ç°é€šè¯å½•åˆ¶ã€è´¨æ£€åˆ†æï¼ˆç›‘ç®¡åˆè§„ï¼‰

### 8.2 AI ç”µè¯é”€å”®åŠ©æ‰‹ â€” æå‡è½¬åŒ–ç‡

| åŠŸèƒ½ | å®ç°æ–¹å¼ | ä¼ä¸šæ”¶ç›Š |
|------|----------|----------|
| å®æ—¶è¯­éŸ³å¯¹è¯ | WebRTC (Kurento/LiveKit) | è‡ªç„¶çš„äººæœºäº¤äº’ä½“éªŒ |
| æ„å›¾è¯†åˆ« | VAD + ASR + LLM | ç²¾å‡†åˆ¤æ–­å®¢æˆ·éœ€æ±‚ |
| æ™ºèƒ½è¯æœ¯æ¨è | LLM å®æ—¶ç”Ÿæˆ | æå‡é”€å”®è½¬åŒ–ç‡ 30%+ |
| é€šè¯å½•éŸ³ä¸åˆ†æ | Kurento MediaPipeline | ä¼˜åŒ–è¯æœ¯ã€åŸ¹è®­æ–°äºº |

### 8.3 è¯­éŸ³å¯¼èˆªä¸é¢„çº¦ç³»ç»Ÿ

å°å¾®è¯Šæ‰€ã€å¾‹å¸ˆäº‹åŠ¡æ‰€ã€ç¾å®¹é™¢ç­‰æœåŠ¡å‹ä¼ä¸šï¼š

- **è¯­éŸ³å¯¼èˆª**ï¼šå®¢æˆ·æ‹¨å…¥åï¼ŒAI è¯­éŸ³å¼•å¯¼é€‰æ‹©æœåŠ¡é¡¹ç›®
- **æ™ºèƒ½é¢„çº¦**ï¼šé€šè¿‡è¯­éŸ³å¯¹è¯å®Œæˆé¢„çº¦ï¼Œè‡ªåŠ¨è®°å½•åˆ°æ—¥ç¨‹
- **å€™è¯Šæé†’**ï¼šTTS è¯­éŸ³ä¸»åŠ¨å›æ‹¨æé†’å®¢æˆ·

### 8.4 å¤šè¯­è¨€å®¢æœï¼ˆå‡ºæµ·ä¼ä¸šï¼‰

- ASR/LLM/TTS æ”¯æŒå¤šè¯­è¨€åˆ‡æ¢
- WebRTC ä¿éšœè·¨å¢ƒé€šè¯è´¨é‡
- ä¸€å¥—ç³»ç»ŸæœåŠ¡å…¨çƒå®¢æˆ·

### 8.5 æˆæœ¬å¯¹æ¯”åˆ†æ

| æ–¹æ¡ˆ | æœˆæˆæœ¬ | èƒ½åŠ› |
|------|--------|------|
| ä¼ ç»Ÿäººå·¥å®¢æœ (5äºº) | Â¥25,000+ | 8h æœåŠ¡ï¼Œèƒ½åŠ›æœ‰é™ |
| å•†ä¸š AI å®¢æœ SaaS | Â¥3,000-10,000 | ä¾èµ–å‚å•†ï¼Œæ•°æ®å¤–æµ |
| **äº‘é›€ + LiveKit** (è‡ªéƒ¨ç½²) | **Â¥500-1,000** (äº‘æœåŠ¡å™¨) | 7Ã—24 æœåŠ¡ï¼Œæ•°æ®è‡ªä¸» |
| **äº‘é›€ + Kurento** (ç§æœ‰éƒ¨ç½²) | **Â¥0** (è‡ªæœ‰æœåŠ¡å™¨) | å®Œå…¨ç§æœ‰ï¼Œé›¶ API è´¹ç”¨ |

> ğŸ’¡ **æ ¸å¿ƒä¼˜åŠ¿**ï¼šå¼€æºå…è´¹ + çº¯ Java ç”Ÿæ€ + å• JAR éƒ¨ç½² = å°å¾®ä¼ä¸šä¹Ÿèƒ½æ‹¥æœ‰ä¼ä¸šçº§ AI è¯­éŸ³å®¢æœ

---

## ä¹ã€å¿«é€Ÿä¸Šæ‰‹æŒ‡å—

### 9.1 æ–¹æ¡ˆä¸€ï¼šLiveKit æ¨¡å¼ï¼ˆæ¨èæ–°æ‰‹ï¼‰

```bash
# 1. å¯åŠ¨ LiveKit Server (Docker)
docker run -d --name livekit \
  -p 7880:7880 -p 7881:7881 -p 7882:7882/udp \
  livekit/livekit-server \
  --dev --bind 0.0.0.0

# 2. ä¿®æ”¹é…ç½®
# application.yaml
webrtc:
  strategy: livekit
  livekit:
    url: "ws://localhost:7880"
    api-key: "devkey"
    api-secret: "secret"

# 3. æ„å»ºå¹¶å¯åŠ¨äº‘é›€
mvn clean package -DskipTests
java -jar target/skylark.jar

# 4. è®¿é—®æ¼”ç¤ºé¡µé¢
open http://localhost:8080/livekit-demo.html
```

### 9.2 æ–¹æ¡ˆäºŒï¼šKurento æ¨¡å¼ï¼ˆéœ€è¦åª’ä½“å¤„ç†ï¼‰

```bash
# 1. å¯åŠ¨ Kurento Media Server (Docker)
docker run -d --name kms \
  -p 8888:8888 \
  -e KMS_MIN_PORT=40000 -e KMS_MAX_PORT=57000 \
  -p 40000-57000:40000-57000/udp \
  kurento/kurento-media-server:latest

# 2. ä¿®æ”¹é…ç½®
# application.yaml
webrtc:
  strategy: kurento
  kurento:
    ws-uri: ws://localhost:8888/kurento

# 3. æ„å»ºå¹¶å¯åŠ¨äº‘é›€
mvn clean package -DskipTests
java -jar target/skylark.jar

# 4. è®¿é—®æ¼”ç¤ºé¡µé¢
open http://localhost:8080/kurento-demo.html
```

### 9.3 API ç«¯ç‚¹ä¸€è§ˆ

| ç­–ç•¥ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|------|
| **é€šç”¨** | POST | `/api/webrtc/{strategy}/session` | åˆ›å»ºä¼šè¯ |
| **é€šç”¨** | DELETE | `/api/webrtc/{strategy}/session/{id}` | å…³é—­ä¼šè¯ |
| **Kurento** | POST | `/api/webrtc/kurento/session/{id}/offer` | SDP Offer |
| **Kurento** | POST | `/api/webrtc/kurento/session/{id}/ice-candidate` | ICE Candidate |
| **LiveKit** | POST | `/api/webrtc/livekit/session` | åˆ›å»ºä¼šè¯ï¼ˆè¿”å› Token + URLï¼‰ |

---

## åã€åç»­è§„åˆ’ä¸å¼€æºå…±å»ºé‚€è¯·

### 10.1 æŠ€æœ¯è·¯çº¿å›¾

```
2026 Q1 âœ…  Kurento 6.18.0 é›†æˆï¼ˆå·²å®Œæˆï¼‰
2026 Q1 âœ…  LiveKit 0.12.0 é›†æˆï¼ˆå·²å®Œæˆï¼‰
2026 Q1 âœ…  ç­–ç•¥æ¨¡å¼ç»Ÿä¸€ WebRTC é€šé“ï¼ˆå·²å®Œæˆï¼‰
         â†“
2026 Q2    å£°ç½‘ Agora SDK é€‚é…
2026 Q3    è…¾è®¯äº‘ TRTC é€‚é…
2026 Q4    é˜¿é‡Œäº‘ RTC / ç½‘æ˜“äº‘ä¿¡é€‚é…
         â†“
2027       å¤š Agent åä½œã€è¯­éŸ³ä¼šè®®ã€å®æ—¶ç¿»è¯‘
```

### 10.2 å¼€æºå…±å»ºï¼šæˆ‘ä»¬éœ€è¦ä½ ï¼

äº‘é›€é¡¹ç›®çš„æˆåŠŸç¦»ä¸å¼€æ¯ä¸€ä½å¼€å‘è€…çš„å‚ä¸ã€‚ä»¥ä¸‹æ˜¯ä½ å¯ä»¥è´¡çŒ®çš„æ–¹å‘ï¼š

| æ–¹å‘ | éš¾åº¦ | è¯´æ˜ |
|------|------|------|
| â­ Star æ”¯æŒ | é›¶é—¨æ§› | è®©æ›´å¤šäººçœ‹åˆ°è¿™ä¸ªé¡¹ç›® |
| ğŸ“ æ–‡æ¡£ç¿»è¯‘ | â­ | å°†ä¸­æ–‡æ–‡æ¡£ç¿»è¯‘ä¸ºè‹±æ–‡ |
| ğŸ› Bug ä¿®å¤ | â­â­ | å‘ç°é—®é¢˜ï¼Œæ Issue æˆ– PR |
| ğŸ§ª æµ‹è¯•ç”¨ä¾‹ | â­â­ | æé«˜æµ‹è¯•è¦†ç›–ç‡ |
| ğŸ”§ æ–°å¢ RTC é€‚é… | â­â­â­ | å®ç° AgoraChannelStrategy ç­‰ |
| ğŸ™ï¸ æ–°å¢ ASR/TTS å¼•æ“ | â­â­â­ | æ¥å…¥ Whisperã€Azure ç­‰ |
| ğŸŒ å‰ç«¯ UI ä¼˜åŒ– | â­â­ | ç¾åŒ–æ¼”ç¤ºé¡µé¢ |

### 10.3 è´¡çŒ®è€…ç¦åˆ©

- âœ… **è´¡çŒ®è€…å¢™**ï¼šä½ çš„å¤´åƒå°†å‡ºç°åœ¨é¡¹ç›®é¦–é¡µ
- âœ… **æŠ€æœ¯æˆé•¿**ï¼šæ·±å…¥ç†è§£ WebRTCã€AI è¯­éŸ³äº¤äº’ã€DDD æ¶æ„
- âœ… **ä¼˜å…ˆæ”¯æŒ**ï¼šè´¡çŒ®è€…äº«æœ‰é—®é¢˜ä¼˜å…ˆå“åº”
- âœ… **é¡¹ç›®å½±å“åŠ›**ï¼šå‚ä¸æŠ€æœ¯é€‰å‹å’Œæ¶æ„è®¨è®º
- âœ… **ç®€å†åŠ åˆ†**ï¼šçœŸå®çš„ä¼ä¸šçº§å¼€æºé¡¹ç›®ç»éªŒ

---

## åä¸€ã€æ€»ç»“

é€šè¿‡å¼•å…¥ **Kurento** å’Œ **LiveKit** åŒ WebRTC æ¡†æ¶ï¼Œäº‘é›€ Voice-Agent å®ç°äº†ä»"åŸºç¡€ WebSocket è¯­éŸ³ä¼ è¾“"åˆ°"ä¸“ä¸šçº§ WebRTC å®æ—¶é€šä¿¡"çš„è·¨è¶Šå¼å‡çº§ã€‚

### æŠ€æœ¯å±‚é¢

| æ”¶ç›Š | è¯´æ˜ |
|------|------|
| **æ ‡å‡†åŒ–** | ä»è‡ªå®šä¹‰ WebSocket å‡çº§åˆ°æ ‡å‡† WebRTC |
| **é«˜è´¨é‡** | æµè§ˆå™¨åŸç”Ÿå›å£°æ¶ˆé™¤ã€é™å™ªã€NAT ç©¿é€ |
| **å¯é€‰æ‹©** | ç­–ç•¥æ¨¡å¼æ”¯æŒ WebSocket / Kurento / LiveKit æ— ç¼åˆ‡æ¢ |
| **å¯æ‰©å±•** | æœªæ¥æ¥å…¥æ›´å¤š RTC æ–¹æ¡ˆåªéœ€å®ç°ä¸€ä¸ªæ¥å£ |
| **ç”Ÿäº§çº§** | å¥åº·æ£€æŸ¥ã€è‡ªåŠ¨é‡è¿ã€ä¼šè¯ç®¡ç†ç­‰ä¼ä¸šçº§ç‰¹æ€§ |

### å•†ä¸šå±‚é¢

| æ”¶ç›Š | è¯´æ˜ |
|------|------|
| **ä½æˆæœ¬** | å¼€æºå…è´¹ï¼Œå°å¾®ä¼ä¸šé›¶æˆæƒè´¹ |
| **å¿«é€Ÿä¸Šçº¿** | LiveKit Token é‰´æƒï¼Œåˆ†é’Ÿçº§æ¥å…¥ |
| **æ•°æ®è‡ªä¸»** | Kurento å…¨é“¾è·¯è‡ªæ‰˜ç®¡ï¼Œæ•°æ®ä¸å‡ºåŸŸ |
| **çµæ´»é€‰æ‹©** | æŒ‰éœ€é€‰æ‹©è½»é‡æˆ–é‡å‹æ–¹æ¡ˆ |
| **æ¸è¿›å‡çº§** | ä»åŸºç¡€åˆ°é«˜çº§ï¼Œæ¯ä¸€æ­¥éƒ½å¹³æ»‘è¿‡æ¸¡ |

> ğŸ¦ **äº‘é›€ï¼ˆSkylarkï¼‰** â€” ç”Ÿäºäº‘ç«¯ï¼Œé¸£äºæŒ‡å°–ã€‚è®©æ¯ä¸€ä¸ªå°å¾®ä¼ä¸šï¼Œéƒ½èƒ½æ‹¥æœ‰è‡ªå·±çš„ AI è¯­éŸ³åŠ©æ‰‹ã€‚

---

## é™„å½•ï¼šå¦‚ä½•å‚ä¸è´¡çŒ®

### ğŸŒŸ ä¸ºä»€ä¹ˆè¦å‚ä¸äº‘é›€å¼€æºé¡¹ç›®ï¼Ÿ

#### å¯¹ä¸ªäººçš„ä»·å€¼
- ğŸ’¡ **æŠ€æœ¯æˆé•¿**ï¼šæ·±å…¥ç†è§£ AI è¯­éŸ³äº¤äº’ã€WebRTC å®æ—¶é€šä¿¡ã€ä¼ä¸šçº§ DDD æ¶æ„
- ğŸ“š **ç»éªŒç§¯ç´¯**ï¼šå‚ä¸çœŸå®çš„ä¼ä¸šçº§é¡¹ç›®ï¼Œç§¯ç´¯å®è´µçš„å¼€æºåä½œç»éªŒ
- ğŸ¯ **èŒä¸šå‘å±•**ï¼šå¼€æºè´¡çŒ®å¯ä»¥æˆä¸ºç®€å†ä¸Šçš„äº®ç‚¹ï¼Œæå‡èŒä¸šç«äº‰åŠ›
- ğŸ¤ **æŠ€æœ¯äº¤æµ**ï¼šç»“è¯†å¿—åŒé“åˆçš„æŠ€æœ¯ä¼™ä¼´ï¼Œæ‹“å±•äººè„‰åœˆå­

#### å¯¹æŠ€æœ¯ç¤¾åŒºçš„æ„ä¹‰
- ğŸŒ **æ¨åŠ¨åˆ›æ–°**ï¼šå…±åŒæ¨è¿› AI è¯­éŸ³äº¤äº’æŠ€æœ¯çš„å‘å±•
- ğŸ”“ **çŸ¥è¯†å…±äº«**ï¼šè®©æ›´å¤šäººèƒ½å¤Ÿæ¥è§¦å’Œå­¦ä¹ å…ˆè¿›çš„æŠ€æœ¯å®è·µ
- ğŸš€ **é™ä½é—¨æ§›**ï¼šè®©å°å¾®ä¼ä¸šä¹Ÿèƒ½æ„å»ºä¸“ä¸šçš„ AI è¯­éŸ³äº¤äº’ç³»ç»Ÿ

### ğŸ¯ å‚ä¸æ–¹å¼

1ï¸âƒ£ â­ **Star æ”¯æŒ** â€” [ç«‹å³ Star](https://github.com/Jashinck/Skylark)  
2ï¸âƒ£ ğŸ“¢ **åˆ†äº«æ¨å¹¿** â€” åœ¨æŠ€æœ¯ç¤¾åŒºåˆ†äº«ä½ çš„ä½¿ç”¨ä½“éªŒ  
3ï¸âƒ£ ğŸ› **æŠ¥å‘Šé—®é¢˜** â€” [æäº¤ Issue](https://github.com/Jashinck/Skylark/issues)  
4ï¸âƒ£ ğŸ“ **å®Œå–„æ–‡æ¡£** â€” æ”¹è¿› READMEã€æ•™ç¨‹ã€API æ–‡æ¡£  
5ï¸âƒ£ ğŸ”§ **è´¡çŒ®ä»£ç ** â€” [æäº¤ Pull Request](https://github.com/Jashinck/Skylark/pulls)  
6ï¸âƒ£ ğŸ’¬ **å‚ä¸è®¨è®º** â€” [åŠ å…¥ Discussion](https://github.com/Jashinck/Skylark/discussions)

### ğŸ“® è”ç³»æˆ‘ä»¬

- **GitHub é¡¹ç›®**ï¼šhttps://github.com/Jashinck/Skylark
- **æäº¤ Issue**ï¼šhttps://github.com/Jashinck/Skylark/issues
- **Pull Request**ï¼šhttps://github.com/Jashinck/Skylark/pulls
- **æŠ€æœ¯è®¨è®º**ï¼šhttps://github.com/Jashinck/Skylark/discussions

---

## ğŸ“£ åŠ å…¥æˆ‘ä»¬ï¼Œä¸€èµ·è®© AI è¯­éŸ³äº¤äº’è§¦æ‰‹å¯åŠï¼

æ— è®ºä½ æ˜¯ï¼š
- ğŸ“ **åœ¨æ ¡å­¦ç”Ÿ** â€” é€šè¿‡å¼€æºé¡¹ç›®æå‡å®æˆ˜èƒ½åŠ›
- ğŸ’¼ **èŒåœºäººå£«** â€” åœ¨å·¥ä½œä¹‹ä½™è´¡çŒ®è‡ªå·±çš„åŠ›é‡
- ğŸ¢ **ä¼ä¸šå¼€å‘è€…** â€” å°†ä¼ä¸šæœ€ä½³å®è·µå›é¦ˆç¤¾åŒº
- ğŸŒŸ **æŠ€æœ¯çˆ±å¥½è€…** â€” çº¯ç²¹çƒ­çˆ±æŠ€æœ¯ï¼Œäº«å—ç¼–ç¨‹ä¹è¶£

æˆ‘ä»¬éƒ½æ¬¢è¿ä½ çš„åŠ å…¥ï¼

ğŸ‘‰ **ç°åœ¨å°±è®¿é—®**ï¼šhttps://github.com/Jashinck/Skylark  
ğŸ‘‰ **ç«‹å³ Star**ï¼šhttps://github.com/Jashinck/Skylark/stargazers  
ğŸ‘‰ **å‚ä¸è´¡çŒ®**ï¼šhttps://github.com/Jashinck/Skylark/contribute

---

<div align="center">

### ğŸ¦ äº‘é›€ (Skylark)

**ç”Ÿäºäº‘ç«¯ï¼Œé¸£äºæŒ‡å°–**

*è®©æ™ºèƒ½è¯­éŸ³äº¤äº’è§¦æ‰‹å¯åŠ*

[![Star on GitHub](https://img.shields.io/github/stars/Jashinck/Skylark?style=social)](https://github.com/Jashinck/Skylark)
[![Fork on GitHub](https://img.shields.io/github/forks/Jashinck/Skylark?style=social)](https://github.com/Jashinck/Skylark)
[![Watch on GitHub](https://img.shields.io/github/watchers/Jashinck/Skylark?style=social)](https://github.com/Jashinck/Skylark)

**ğŸŒŸ å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ Star æ”¯æŒï¼**

[â­ Star é¡¹ç›®](https://github.com/Jashinck/Skylark) Â· [ğŸ“– é˜…è¯»æ–‡æ¡£](https://github.com/Jashinck/Skylark#readme) Â· [ğŸ’¬ å‚ä¸è®¨è®º](https://github.com/Jashinck/Skylark/discussions) Â· [ğŸ› æŠ¥å‘Šé—®é¢˜](https://github.com/Jashinck/Skylark/issues)

</div>

---

**åŸåˆ›æŠ€æœ¯åˆ†äº« | å¼€æºé¡¹ç›®æ¨å¹¿ | è½¬è½½è¯·æ³¨æ˜å‡ºå¤„å¹¶é™„ä¸Šé¡¹ç›®é“¾æ¥**

ğŸ“ **é¡¹ç›®åœ°å€**ï¼šhttps://github.com/Jashinck/Skylark

---

## ğŸ·ï¸ æ ‡ç­¾

`#AI` `#è¯­éŸ³è¯†åˆ«` `#è¯­éŸ³åˆæˆ` `#å®æ—¶äº’åŠ¨` `#å¼€æºé¡¹ç›®` `#Java` `#SpringBoot` `#WebRTC` `#Kurento` `#LiveKit` `#VoiceAgent` `#VAD` `#ASR` `#TTS` `#LLM` `#RTC` `#ç­–ç•¥æ¨¡å¼` `#DDD` `#å°å¾®ä¼ä¸š` `#æ™ºèƒ½å®¢æœ`

---

> ğŸ’¡ **æ¸©é¦¨æç¤º**ï¼š
> - æœ¬æ–‡ä»‹ç»çš„äº‘é›€ï¼ˆSkylarkï¼‰é¡¹ç›®å®Œå…¨å¼€æºå…è´¹ï¼Œæ¬¢è¿ Starã€Fork å’Œè´¡çŒ®
> - é¡¹ç›®æŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿å…³æ³¨é¡¹ç›®åŠ¨æ€
> - å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ GitHub ä¸Šæ Issue æˆ–å‚ä¸è®¨è®º
> - æœŸå¾…ä¸ä½ ä¸€èµ·ï¼Œç”¨å¼€æºçš„åŠ›é‡ï¼Œè®© AI è¯­éŸ³äº¤äº’è§¦æ‰‹å¯åŠï¼
